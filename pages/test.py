import streamlit as st
from collections import Counter

# í˜ì´ì§€ ê¸°ë³¸ ì„¤ì •
st.set_page_config(
    page_title="ë‚˜ì˜ ëŒ€í•™ ì „ê³µ ì°¾ê¸°",
    page_icon="ğŸ“",
    layout="centered"
)

# --- ë°ì´í„° ì„¤ì • (ì§ˆë¬¸ê³¼ ì ìˆ˜ ë¡œì§) ---
# ê° ë‹µë³€ì´ ì–´ë–¤ ì„±í–¥(Type)ì— ì ìˆ˜ë¥¼ ì¤„ì§€ ì •ì˜í•©ë‹ˆë‹¤.
# R: í˜„ì‹¤í˜• (ê¸°ê³„/ê³µí•™), I: íƒêµ¬í˜• (ìì—°ê³¼í•™/ì—°êµ¬), A: ì˜ˆìˆ í˜• (ë””ìì¸/ì°½ì‘)
# S: ì‚¬íšŒí˜• (êµìœ¡/ë³µì§€), E: ì§„ì·¨í˜• (ê²½ì˜/ì–¸ë¡ ), C: ê´€ìŠµí˜• (íšŒê³„/ì‚¬ë¬´)

questions = [
    {
        "question": "1. ì—¬ê°€ ì‹œê°„ì— ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë‚˜ìš”?",
        "options": {
            "ë¬´ì–¸ê°€ë¥¼ ì¡°ë¦½í•˜ê±°ë‚˜ ê¸°ê³„ë¥¼ ë§Œì§„ë‹¤.": "R",
            "ê³¼í•™ ë‹¤íë©˜í„°ë¦¬ë¥¼ ë³´ê±°ë‚˜ ë…¼ë¦¬ì ì¸ í€´ì¦ˆë¥¼ í‘¼ë‹¤.": "I",
            "ê·¸ë¦¼ì„ ê·¸ë¦¬ê±°ë‚˜ ê¸€ì„ ì“´ë‹¤.": "A",
            "ì¹œêµ¬ë“¤ì˜ ê³ ë¯¼ì„ ë“¤ì–´ì£¼ê±°ë‚˜ ëŒ€í™”í•œë‹¤.": "S"
        }
    },
    {
        "question": "2. í•™êµì—ì„œ ê°€ì¥ í¥ë¯¸ë¡œì› ë˜ ê³¼ëª©ì€?",
        "options": {
            "ìˆ˜í•™, ë¬¼ë¦¬, ì •ë³´": "R",
            "ìƒë¬¼, í™”í•™, ì§€êµ¬ê³¼í•™": "I",
            "ìŒì•…, ë¯¸ìˆ , ë¬¸í•™": "A",
            "ì‚¬íšŒ, ìœ¤ë¦¬, ì—­ì‚¬": "S"
        }
    },
    {
        "question": "3. íŒ€ í”„ë¡œì íŠ¸ë¥¼ í•  ë•Œ ì„ í˜¸í•˜ëŠ” ì—­í• ì€?",
        "options": {
            "ìë£Œë¥¼ ë¶„ì„í•˜ê³  ì •ë¦¬í•˜ëŠ” ì—­í• ": "C",
            "ë°œí‘œë¥¼ í•˜ê±°ë‚˜ íŒ€ì„ ì´ë„ëŠ” ë¦¬ë”": "E",
            "ì•„ì´ë””ì–´ë¥¼ ë‚´ê³  PPTë¥¼ ì˜ˆì˜ê²Œ ê¾¸ë¯¸ëŠ” ì—­í• ": "A",
            "íŒ€ì›ë“¤ ê°„ì˜ ì˜ê²¬ì„ ì¡°ìœ¨í•˜ëŠ” ì—­í• ": "S"
        }
    },
    {
        "question": "4. ë¯¸ë˜ì— ê°–ê³  ì‹¶ì€ ì§ì—…ì˜ ëª¨ìŠµì€?",
        "options": {
            "ì •í™•í•œ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê³  ì²´ê³„ì ì¸ ì¼": "C",
            "ì°½ì—…ì„ í•˜ê±°ë‚˜ ë†’ì€ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ” ì¼": "E",
            "ìƒˆë¡œìš´ ê¸°ìˆ ì„ ê°œë°œí•˜ê±°ë‚˜ ì—°êµ¬í•˜ëŠ” ì¼": "I",
            "ì–´ë ¤ìš´ ì‚¬ëŒì„ ë•ê±°ë‚˜ ê°€ë¥´ì¹˜ëŠ” ì¼": "S"
        }
    },
    {
        "question": "5. ë§Œì•½ ë¡œë˜ì— ë‹¹ì²¨ëœë‹¤ë©´?",
        "options": {
            "ìµœì‹ í˜• ì»´í“¨í„°ë‚˜ ì¥ë¹„ë¥¼ ì‚°ë‹¤.": "R",
            "ì£¼ì‹ì´ë‚˜ ë¶€ë™ì‚° íˆ¬ìë¥¼ ê³µë¶€í•´ì„œ ë¶ˆë¦°ë‹¤.": "E",
            "ì„¸ê³„ ì¼ì£¼ë¥¼ í•˜ë©° ì‚¬ì§„ì„ ì°ê³  ì—ì„¸ì´ë¥¼ ì“´ë‹¤.": "A",
            "ê¸°ë¶€ ì¬ë‹¨ì„ ì„¤ë¦½í•´ ìš´ì˜í•œë‹¤.": "S"
        }
    }
]

# ì„±í–¥ë³„ ì¶”ì²œ í•™ê³¼ ë§¤í•‘
recommendations = {
    "R": {"name": "ê³µí•™ ê³„ì—´ (ê¸°ê³„, ì»´ê³µ, ì „ê¸°ì „ì)", "desc": "ì‚¬ë¬¼, ë„êµ¬, ê¸°ê³„ë¥¼ ë‹¤ë£¨ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ë©° ì‹¤ìš©ì ì¸ ê¸°ìˆ ì— ê°•ì ì´ ìˆìŠµë‹ˆë‹¤."},
    "I": {"name": "ìì—°ê³¼í•™ ê³„ì—´ (ë¬¼ë¦¬, í™”í•™, ìƒëª…)", "desc": "ì§€ì  í˜¸ê¸°ì‹¬ì´ ë§ê³  í˜„ìƒì˜ ì›ë¦¬ë¥¼ íƒêµ¬í•˜ëŠ” ê²ƒì„ ì¦ê¹ë‹ˆë‹¤."},
    "A": {"name": "ì˜ˆìˆ /ì¸ë¬¸ ê³„ì—´ (ë””ìì¸, ë¬¸ì˜ˆì°½ì‘)", "desc": "ì°½ì˜ì ì´ê³  ììœ ë¶„ë°©í•˜ë©° ê°ìˆ˜ì„±ì´ í’ë¶€í•˜ì—¬ í‘œí˜„í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤."},
    "S": {"name": "ì‚¬íšŒ/êµìœ¡ ê³„ì—´ (ì‹¬ë¦¬, ì‚¬íšŒë³µì§€, êµìœ¡)", "desc": "ë‹¤ë¥¸ ì‚¬ëŒì„ ë•ê±°ë‚˜ ê°€ë¥´ì¹˜ëŠ” ì¼ì— ë³´ëŒì„ ëŠë‚ë‹ˆë‹¤."},
    "E": {"name": "ê²½ì˜/ì‚¬íšŒê³¼í•™ ê³„ì—´ (ê²½ì˜, ê²½ì œ, ì •ì¹˜)", "desc": "ì¡°ì§ì„ ì´ëŒê±°ë‚˜ ì„¤ë“í•˜ê³ , ëª©í‘œë¥¼ ì„±ì·¨í•˜ëŠ” ê²ƒì„ ì¢‹ì•„í•©ë‹ˆë‹¤."},
    "C": {"name": "ë°ì´í„°/í–‰ì • ê³„ì—´ (í†µê³„, íšŒê³„, ë¬¸í—Œì •ë³´)", "desc": "ìë£Œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•˜ê³  ì •í™•í•˜ê²Œ ì²˜ë¦¬í•˜ëŠ” ëŠ¥ë ¥ì´ ë›°ì–´ë‚©ë‹ˆë‹¤."}
}

# --- UI êµ¬ì„± ---

st.title("ğŸ“ ë‚˜ì—ê²Œ ë§ëŠ” ì „ê³µì€?")
st.write("ê°„ë‹¨í•œ 5ê°€ì§€ ì§ˆë¬¸ì„ í†µí•´ ë‹¹ì‹ ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” **ëŒ€í•™ í•™ê³¼ 2ê°œ**ë¥¼ ì¶”ì²œí•´ ë“œë¦½ë‹ˆë‹¤.")
st.markdown("---")

# í¼(Form)ì„ ì‚¬ìš©í•˜ì—¬ ì œì¶œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ í•œ ë²ˆì— ì²˜ë¦¬
with st.form("aptitude_test"):
    responses = []
    
    for i, q_data in enumerate(questions):
        st.subheader(q_data["question"])
        # ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒì§€ ìƒì„± (í‚¤ ê°’ì€ ìœ ë‹ˆí¬í•´ì•¼ í•¨)
        choice = st.radio(
            label="ë‹µë³€ì„ ì„ íƒí•˜ì„¸ìš”",
            options=q_data["options"].keys(),
            key=f"q_{i}",
            label_visibility="collapsed" # ë¼ë””ì˜¤ ë²„íŠ¼ ë¼ë²¨ ìˆ¨ê¹€ (ê¹”ë”í•˜ê²Œ)
        )
        responses.append(q_data["options"][choice])
    
    st.markdown("---")
    submitted = st.form_submit_button("ê²°ê³¼ í™•ì¸í•˜ê¸°")

# --- ê²°ê³¼ ì²˜ë¦¬ ë¡œì§ ---

if submitted:
    # 1. ì ìˆ˜ ì§‘ê³„ (Counter ì‚¬ìš©)
    # ì„ íƒëœ ë‹µë³€ë“¤ì˜ ì„±í–¥ ì½”ë“œë¥¼ ëª¨ì•„ì„œ ê°œìˆ˜ë¥¼ ì…‰ë‹ˆë‹¤.
    score_counts = Counter(responses)
    
    # 2. ê°€ì¥ ë§ì´ ì„ íƒëœ ìƒìœ„ 2ê°œ ì„±í–¥ ì¶”ì¶œ
    # most_common(n)ì€ (í•­ëª©, ê°œìˆ˜) íŠœí”Œì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    top_2 = score_counts.most_common(2)
    
    st.success("ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‘‡")
    st.markdown("### ğŸ† ë‹¹ì‹ ì„ ìœ„í•œ ì¶”ì²œ í•™ê³¼")
    
    # ê²°ê³¼ ë³´ì—¬ì£¼ê¸°
    col1, col2 = st.columns(2)
    
    # ì²« ë²ˆì§¸ ì¶”ì²œ
    if len(top_2) >= 1:
        type_code = top_2[0][0]
        rec_info = recommendations.get(type_code, {})
        with col1:
            st.info(f"ğŸ¥‡ 1ìˆœìœ„: **{rec_info['name']}**")
            st.caption(rec_info['desc'])
            
    # ë‘ ë²ˆì§¸ ì¶”ì²œ (ë™ì ì ì²˜ë¦¬ëŠ” ë‹¨ìˆœíˆ ë¦¬ìŠ¤íŠ¸ ìˆœì„œëŒ€ë¡œ í•¨)
    if len(top_2) >= 2:
        type_code = top_2[1][0]
        rec_info = recommendations.get(type_code, {})
        with col2:
            st.info(f"ğŸ¥ˆ 2ìˆœìœ„: **{rec_info['name']}**")
            st.caption(rec_info['desc'])
    elif len(top_2) == 1:
        # í•œ ê°€ì§€ ì„±í–¥ë§Œ ì••ë„ì ìœ¼ë¡œ ì„ íƒí–ˆì„ ê²½ìš°
        st.write("ë‹¹ì‹ ì€ í™•ê³ í•œ ì·¨í–¥ì„ ê°€ì§€ì…¨êµ°ìš”! 2ìˆœìœ„ëŠ” ë‹¤ë¥¸ ë¶„ì•¼ë¥¼ íƒìƒ‰í•´ë³´ì„¸ìš”.")

    st.balloons() # ì¶•í•˜ íš¨ê³¼
